<?xml version="1.0" encoding="iso-8859-1" ?>
<table>
  <base>CRM/Contribute</base>
  <class>ContributionRecur</class>
  <name>civicrm_contribution_recur</name>
  <add>1.4</add>
  <field>
      <name>id</name>
      <type>int unsigned</type>
      <required>true</required>
      <comment>Contribution Recur ID</comment>
      <add>1.4</add>
  </field>
  <primaryKey>
       <name>id</name>
       <autoincrement>true</autoincrement>
  </primaryKey>
  <field>
      <name>contact_id</name>
      <type>int unsigned</type>
      <required>true</required>
      <comment>Foreign key to civicrm_contact.id .</comment>
      <add>1.4</add>
  </field>
  <foreignKey>
       <name>contact_id</name>
       <table>civicrm_contact</table>
       <key>id</key>
       <add>1.4</add>
  </foreignKey>
  <field>
       <name>amount</name>
       <type>decimal</type>
       <required>true</required>
       <comment>Amount to be contributed or charged each recurrence.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>frequency_unit</name>
       <type>enum</type> 
       <values>day,week,month,year</values>
       <default>'month'</default>
       <comment>Time units for recurrence of payment.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>frequency_interval</name>
       <type>int unsigned</type>
       <required>true</required>
       <comment>Number of time units for recurrence of payment.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>installments</name>
       <type>int unsigned</type>
       <comment>Total number of payments to be made. Set this to 0 if this is an open-ended commitment i.e. no set end date.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>start_date</name>
       <type>date</type>
       <required>true</required>
       <comment>The date the first scheduled recurring contribution occurs.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>create_date</name>
       <type>date</type>
       <required>true</required>
       <comment>When this recurring contribution record was created.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>modified_date</name>
       <type>date</type>
       <required>true</required>
       <comment>Last updated date for this record.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>cancel_date</name>
       <type>date</type>
       <required>true</required>
       <comment>Date this recurring contribution was cancelled by contributor- if we can get access to it ??</comment>
       <add>1.4</add>
  </field>
  <field>     
      <name>is_active</name>
      <type>boolean</type> 
      <required>true</required> 
      <comment>Set to false by contributor cancellation or greater than max permitted failures - if we know about that.</comment>  
      <add>1.4</add>  
  </field>
  <field>
       <name>cycle_day</name>
       <type>int unsigned</type>
       <default>1</default>
       <required>true</required>
       <comment>Day in the period when the payment should be charged e.g. 1st of month, 15th etc.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>next_sched_contribution</name>
       <type>date</type>
       <required>true</required>
       <comment>At Groundspring this was used by the cron job which triggered payments. If we\'re not doing that but we know about payments, it might still be useful to store for display to org andor contributors.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>failure_count</name>
       <type>int unsigned</type>
       <default>0</default>
       <comment>Number of failed charge attempts since last success. Business rule could be set to deactivate on more than x failures.</comment>
       <add>1.4</add>
  </field>
  <field>
       <name>failure_retry_date</name>
       <type>date</type>
       <comment>At Groundspring we set a business rule to retry failed payments every 7 days - and stored the next scheduled attempt date there.</comment>
       <add>1.4</add>
  </field>
  <field>   
      <name>processor_id</name>
      <type>varchar</type>   
      <length>255</length>
      <comment>Possibly needed to store a unique identifier for this recurring payment order - if this is available from the processor??</comment>   
      <add>1.4</add>   
  </field>  
  <field>     
      <name>auto_renew</name>
      <type>boolean</type> 
      <required>true</required> 
      <default>0</default>
      <comment>Some systems allow contributor to set a number of installments - but then auto-renew the subscription or commitment if they do not cancel.</comment>  
      <add>1.4</add>  
  </field>
</table>
